{"version":3,"sources":["../../../../src/server/lib/incremental-cache/file-system-cache.ts"],"names":["LRUCache","path","NEXT_CACHE_TAGS_HEADER","NEXT_DATA_SUFFIX","NEXT_META_SUFFIX","RSC_PREFETCH_SUFFIX","RSC_SUFFIX","memoryCache","tagsManifest","FileSystemCache","constructor","ctx","fs","flushToDisk","serverDistDir","appDir","_appDir","pagesDir","_pagesDir","revalidatedTags","experimental","debug","process","env","NEXT_PRIVATE_DEBUG_CACHE","maxMemoryCacheSize","console","log","max","length","value","JSON","kind","stringify","props","Error","data","body","html","pageData","tagsManifestPath","join","loadTagsManifest","parse","readFileSync","err","version","items","revalidateTag","tag","revalidatedAt","Date","now","mkdir","dirname","writeFile","warn","get","args","key","tags","softTags","kindHint","NEXT_RUNTIME","filePath","getFilePath","fileData","readFile","mtime","stat","meta","replace","cacheEntry","lastModified","getTime","headers","status","_","detectFileKind","isAppPath","parsedData","storedTags","every","includes","set","ppr","postponed","cacheTags","tagsHeader","split","isStale","some","undefined","combinedTags","wasRevalidated","htmlPath","pathname","existsSync"],"mappings":"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"}